
diff --git a/lisp/mac-voices.el b/lisp/mac-voices.el
index 82069c536..332ecec5b 100644
--- a/lisp/mac-voices.el
+++ b/lisp/mac-voices.el
@@ -106,8 +106,8 @@ COMMAND-STRING to the TTS engine."
 ;;{{{ voice definitions
 
 ;;; the nine predefined voices: TODO: figure out if embedding is possible (and update voice names).
-(mac-define-voice 'paul  " [{voice alex}] ")
-(mac-define-voice 'harry " [{voice ralf}] ")
+(mac-define-voice 'paul  " [{voice systemDefault}] ")
+(mac-define-voice 'harry " [{voice alex}] ")
 (mac-define-voice 'dennis " [{voice bruce}] ")
 (mac-define-voice 'frank " [{voice fred}] ")
 (mac-define-voice 'betty " [{voice victoria}] ")
diff --git a/servers/mac b/servers/mac
index f06d48d53..0a0122332 100755
--- a/servers/mac
+++ b/servers/mac
@@ -560,9 +560,13 @@ def processSpeechQueue():
       writeDebugLog(4, "Voice change")
       voice = item[1]
       if voice in voiceMap:
-        speechSynthesizer.setVoice_(voiceMap[voice])
-        writeDebugLog(6, "set voice to " + voiceMap[voice])  
-        processSpeechQueue()
+        voice = voiceMap[voice]
+      else:
+        voice = NSSpeechSynthesizer.defaultVoice()
+      if voice != speechSynthesizer.voice():
+        speechSynthesizer.setVoice_(voice)
+        writeDebugLog(6, "set voice to " + voice)
+      processSpeechQueue()
 
     # Custom embeds.
     elif item[0] == 'textclip':

On Fri, Aug 4, 2017 at 8:42 PM, Marshall handheld Flax <m.droid.flax@gmail.com> wrote:

 Thank you...I applied the patch and it looks perfect so far.  When I change the Voiceover voice via the OS "system preferences", the change applies immediately.   My only question about the patch is whether
 you want to log when a voice changes, which the code did before.  Or is logging too expensive now that you would have to do a NSSpeechSynthesizer.attributesForVoice_(voice)['VoiceName'] just for the
 logging?

 Thanks again!

 Marshall

 On Fri, Aug 4, 2017 at 10:20 PM, David Tseng <davidtseng@gmail.com> wrote:

 See patch below. Setting the voice does appear to cause lag, so we only set it if needed (i.e. if the new voice differs from the current one).

 diff --git a/lisp/mac-voices.el b/lisp/mac-voices.el
 index 82069c536..332ecec5b 100644
 --- a/lisp/mac-voices.el
 +++ b/lisp/mac-voices.el
 @@ -106,8 +106,8 @@ COMMAND-STRING to the TTS engine."
  ;;{{{ voice definitions
  
  ;;; the nine predefined voices: TODO: figure out if embedding is possible (and update voice names).
 -(mac-define-voice 'paul  " [{voice alex}] ")
 -(mac-define-voice 'harry " [{voice ralf}] ")
 +(mac-define-voice 'paul  " [{voice systemDefault}] ")
 +(mac-define-voice 'harry " [{voice alex}] ")
  (mac-define-voice 'dennis " [{voice bruce}] ")
  (mac-define-voice 'frank " [{voice fred}] ")
  (mac-define-voice 'betty " [{voice victoria}] ")
 diff --git a/servers/mac b/servers/mac
 index f06d48d53..ce07ed273 100755
 --- a/servers/mac
 +++ b/servers/mac
 @@ -560,9 +560,12 @@ def processSpeechQueue():
        writeDebugLog(4, "Voice change")
        voice = item[1]
        if voice in voiceMap:
 -        speechSynthesizer.setVoice_(voiceMap[voice])
 -        writeDebugLog(6, "set voice to " + voiceMap[voice])  
 -        processSpeechQueue()
 +        voice = voiceMap[voice]
 +      else:
 +        voice = NSSpeechSynthesizer.defaultVoice()
 +      if voice != speechSynthesizer.voice():
 +        speechSynthesizer.setVoice_(voice)
 +      processSpeechQueue()
  
      # Custom embeds.
      elif item[0] == 'textclip':
